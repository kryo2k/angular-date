/*!
* angular-date
* Simple & useful, native date manipulation library for Angular 1.x
* @license GPL
* @author Hans Doller <hans@ticonerd.com>
*/
angular.module('ngDate',[]).service('$date',function(){var h={week:['wk','week','weeks'],ms:['ms','milli','millisecond','milliseconds'],sec:['s','sec','second','seconds'],min:['min','minute','minutes'],hr:['h','hr','hrs','hour','hours'],day:['d','day','days'],mon:['mon','month','months'],year:['y','year','years']},unitMs={ms:1,sec:1000,min:60000,hr:3600000,day:8.64e7,week:8.64e7*7};this.SUNDAY=0;this.MONDAY=1;this.TUESDAY=2;this.WEDNESDAY=3;this.THURSDAY=4;this.FRIDAY=5;this.SATURDAY=6;this.JANUARY=0;this.FEBRUARY=1;this.MARCH=2;this.APRIL=3;this.MAY=4;this.JUNE=5;this.JULY=6;this.AUGUST=7;this.SEPTEMBER=8;this.OCTOBER=9;this.NOVEMBER=10;this.DECEMBER=11;this.ms=function(a){var b=Date.now();if(angular.isDate(a)){b=a.getTime()}else if(angular.isNumber(a)){b=a}else if(angular.isString(a)){var c=Date.parse(a);if(!isNaN(c))b=c}return b};this.now=function(a){if(angular.isDate(a)){return a}return new Date(this.ms(a))};this.validDay=function(n){return angular.isNumber(n)&&!isNaN(n)&&n>=this.SUNDAY&&n<=this.SATURDAY};this.nearestDay=function(a,b){a=this.validDay(a)?a:this.THURSDAY;b=this.now(this.ms(b));b.setDate(b.getDate()+(a-b.getDay()));return b};this.futureDay=function(a,b){var c=this.nearestDay(a,b);if(c<this.now(b)){c.setDate(c.getDate()+7)}return c};this.pastDay=function(a,b){var c=this.nearestDay(a,b);if(c>this.now(b)){c.setDate(c.getDate()-7)}return c};this.dayOfWeek=function(a,b){a=this.ms(a);var c=this.getYearWeek(a,b);return Math.ceil((a-c[2].getTime())/unitMs.day)};this.dayOfYear=function(a){a=this.now(a);var b=[0,31,59,90,120,151,181,212,243,273,304,334],mn=a.getMonth(),dn=a.getDate(),dayOfYear=b[mn]+dn;if(mn>1&&this.isLeapYear(a))dayOfYear++;return dayOfYear};this.firstOfYear=function(a,b){a=angular.isNumber(a)?a:(new Date()).getFullYear();if(b){return new Date(Date.UTC(a,this.JANUARY,1,0,0,0,0))}return new Date(a,0,1,0,0,0)};this.lastOfYear=function(a,b){if(b){return new Date(Date.UTC(a,this.DECEMBER,31,23,59,59,999))}return new Date(a,this.DECEMBER,31,23,59,59,999)};this.daysInYear=function(a){return this.dayOfYear(this.lastOfYear(a))};this.daysInMonth=function(a,b,c){return this.lastOfMonth(a,b,c).getDate()};this.firstOfMonth=function(a,b,c){if(c){return new Date(Date.UTC(b,a,1,0,0,0,0))}return new Date(b,a,1,0,0,0,0)};this.lastOfMonth=function(a,b,c){var d=this.firstOfMonth(a+1,b,c);return new Date(d-1)};this.utcOffset=function(a){return this.now(a).getTimezoneOffset()*unitMs.min};this.stdTimezoneOffset=function(a){var a=this.now(a);var b=new Date(a.getFullYear(),0,1);var c=new Date(a.getFullYear(),6,1);return Math.max(this.utcOffset(b),this.utcOffset(c))};this.dstOffset=function(a){var b=this.stdTimezoneOffset(),curOffset=this.utcOffset(a);return(curOffset<b)?(b-curOffset):0};this.isDST=function(a){return this.utcOffset(a)<this.stdTimezoneOffset()};this.isLeapYear=function(a){var b=this.now(a).getFullYear();if((b&3)!=0)return false;return((b%100)!=0||(b%400)==0)};this.getYearWeek=function(a,b){a=this.pastDay(b,a);var c=this.firstOfYear(a.getFullYear()),weekNo=Math.ceil((((a.getTime()-c.getTime())/unitMs.day)+1)/7);return[a.getFullYear(),weekNo,this.startOf(a,'day'),this.endOf(a.getTime()+(unitMs.week-1),'day')]};this.round=function(c,d,e){e=angular.isFunction(e)?e:Math.round;c=this.ms(c);var f=function(n,a){if(!angular.isNumber(n))return NaN;if(angular.isNumber(a)){var b=n%a,rounded=e(b/a)*a;return n-b+rounded}return e(n)},roundDayOffset=function(a,b){return f(a,b)*unitMs.day},dateMod=(function(a){var b=this.utcOffset(c);return new Date(f(c-b,a)+b)}).bind(this);d=String(d||'ms').toLowerCase();switch(true){case h.ms.indexOf(d)>-1:return dateMod(unitMs.ms);case h.sec.indexOf(d)>-1:return dateMod(unitMs.sec);case h.min.indexOf(d)>-1:return dateMod(unitMs.min);case h.hr.indexOf(d)>-1:return dateMod(unitMs.hr);case h.day.indexOf(d)>-1:return dateMod(unitMs.day)}var g=new Date(c),cmon=g.getMonth(),cyr=g.getFullYear(),cdt=g.getDate();switch(true){case h.mon.indexOf(d)>-1:return new Date(this.firstOfMonth(cmon,cyr).getTime()+roundDayOffset(cdt,this.daysInMonth(cmon,cyr)));case h.year.indexOf(d)>-1:return new Date(this.firstOfYear(cyr).getTime()+roundDayOffset(this.dayOfYear(g),this.daysInYear(cyr)))}return false};this.ceil=function(a,b){return this.round(a,b,Math.ceil)};this.floor=function(a,b){return this.round(a,b,Math.floor)};this.startOf=function(a,b){return this.floor(a,b)};this.endOf=function(a,b){return new Date(this.ceil(a,b).getTime()-1)};this.compare=function(a,b){var c=this.ms(a),bms=this.ms(b);if(c>bms)return 1;if(c<bms)return-1;return 0};this.between=function(v,a,b){return this.compare(v,a)>=0&&this.compare(v,b)<=0};this.equal=function(a,b,d,e){var p=[],getYearWeek=this.getYearWeek.bind(this),getWeek=function(){var a=getYearWeek(this,e);return a.slice(0,2).join('-')};d=String(d||'ms').toLowerCase();switch(true){case h.week.indexOf(d)>-1:p.push(getWeek);break;case h.ms.indexOf(d)>-1:p.push(Date.prototype.getMilliseconds);case h.sec.indexOf(d)>-1:p.push(Date.prototype.getSeconds);case h.min.indexOf(d)>-1:p.push(Date.prototype.getMinutes);case h.hr.indexOf(d)>-1:p.push(Date.prototype.getHours);case h.day.indexOf(d)>-1:p.push(Date.prototype.getDate);case h.mon.indexOf(d)>-1:p.push(Date.prototype.getMonth);case h.year.indexOf(d)>-1:p.push(Date.prototype.getFullYear)}a=this.now(a);b=this.now(b);return p.every(function(c){return c.call(a)===c.call(b)})}});